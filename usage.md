# 스마트 가계부 사용법

## 1. 데이터베이스 설정

먼저 PostgreSQL 데이터베이스를 설정해야 합니다.

### 1.1 PostgreSQL 설치 및 데이터베이스 생성

```bash
# PostgreSQL 설치 (macOS)
brew install postgresql

# PostgreSQL 서비스 시작
brew services start postgresql

# 데이터베이스 생성
createdb smart_budget
```

### 1.2 환경변수 설정

프로젝트 루트에 `.env.local` 파일을 생성하고 다음 내용을 추가하세요:

```env
DB_USER=postgres
DB_HOST=localhost
DB_NAME=smart_budget
DB_PASSWORD=your_password
DB_PORT=5432
```

### 1.3 스키마 생성

PostgreSQL에 접속하여 스키마를 생성합니다:

```bash
psql -d smart_budget -f lib/db-schema.sql
```

## 2. 애플리케이션 실행

```bash
# 패키지 설치
npm install

# 개발 서버 실행
npm run dev
```

브라우저에서 `http://localhost:3000`으로 접속합니다.

## 3. 기능 사용법

### 3.1 대시보드 탭

- **자산 현황**: 현금, 주식, 부동산, 부채의 총합을 보여줍니다
- **주요 지표**: 총 수입, 저축율, 주식 수익률을 표시합니다
- **월별 순자산 추이**: Y축이 억 단위(0.5억 간격)로 표시되는 라인 차트
- **유동자산 추이**: 현금성과 주식을 스택으로 쌓은 막대 그래프, Y축 숨김, X축은 1월~12월 표시, 막대 상단에 총액 표시
- **월별 순저축**: 매월 저축한 금액을 막대 그래프로 표시, Y축 숨김, X축은 1월~12월 표시
- **월별 변동지출**: 매월 변동지출 총액을 막대 그래프로 표시, Y축 숨김, X축은 1월~12월 표시

### 3.2 월별 관리 탭

#### 3.2.1 수입 관리
- **남편/아내 수입**: 각각 별도로 수입 항목을 추가하고 관리할 수 있습니다
- 수입원별로 세분화하여 기록 가능합니다

#### 3.2.2 저축 관리
- 저축 계좌별로 입금한 금액을 기록합니다
- 저축된 금액은 자동으로 현금 자산에 반영됩니다

#### 3.2.3 지출 관리
- **고정지출**: 매월 정기적으로 나가는 지출 (집세, 보험료 등)
- **변동지출**: 카테고리별로 관리되는 변동 지출
  - 카테고리 추가: "식비", "교통비", "문화생활" 등 원하는 카테고리를 추가할 수 있습니다
  - 카테고리 삭제: X 버튼을 클릭하여 카테고리와 관련된 모든 데이터를 삭제할 수 있습니다

#### 3.2.4 주식 거래
- **매수**: 주식 종목명, 수량, 매입 단가를 입력합니다
- **매도**: 매도한 주식 정보를 입력합니다
- 거래 내역은 자동으로 주식 자산에 반영됩니다

#### 3.2.5 부채 상환
- 부채별로 상환한 금액을 기록합니다
- 상환된 금액만큼 부채가 감소됩니다

### 3.3 데이터 저장

월별 관리 탭에서 모든 데이터를 입력한 후 **"저장하기"** 버튼을 클릭하면:

1. 월별 수입/지출 데이터가 데이터베이스에 저장됩니다
2. 저축, 주식 거래, 부채 상환이 자산에 자동 반영됩니다
3. **파킹통장 자동 계산**: 총 수입에서 저축, 부채상환, 고정지출, 변동지출을 뺀 잉여 자금이 "파킹통장"에 자동으로 추가됩니다
4. 순자산이 재계산되어 업데이트됩니다
5. 대시보드의 차트에 새로운 데이터가 반영됩니다

#### 3.3.1 파킹통장 기능
- **자동 계산**: 파킹통장 = 총 수입 - 저축 - 부채상환 - 고정지출 - 변동지출
- **자동 반영**: 양수인 경우에만 현금 자산에 "파킹통장" 항목으로 추가됩니다
- **월별 요약**: 월별 관리 탭에서 실시간으로 파킹통장 잔액을 확인할 수 있습니다

## 4. 데이터 구조

### 4.1 자산 (Assets)
- **현금**: 예금, 적금, 현금 등
- **주식**: 보유 주식의 수량과 평균 매입가
- **부동산**: 부동산 자산 가치
- **부채**: 대출, 신용카드 잔액 등

### 4.2 월별 데이터 (Monthly Data)
- **수입**: 남편/아내별 수입 내역
- **저축**: 월별 저축 내역
- **고정지출**: 매월 정기 지출
- **변동지출**: 카테고리별 변동 지출
- **주식거래**: 매수/매도 내역
- **부채상환**: 부채 상환 내역
- **순자산**: 해당 월의 총 순자산

## 5. 팁과 주의사항

1. **정기적인 업데이트**: 매월 말에 데이터를 입력하는 것을 권장합니다
2. **카테고리 관리**: 변동지출 카테고리는 본인의 소비 패턴에 맞게 설정하세요
3. **자산 반영**: 저축이나 주식 거래 시 자산이 자동으로 업데이트되므로 중복 입력하지 마세요
4. **백업**: 정기적으로 데이터베이스를 백업하는 것을 권장합니다

## 6. 문제 해결

### 6.1 데이터베이스 연결 오류
- PostgreSQL 서비스가 실행 중인지 확인하세요
- `.env.local` 파일의 데이터베이스 설정을 확인하세요

### 6.2 데이터 저장 실패
- 네트워크 연결을 확인하세요
- 브라우저 콘솔에서 오류 메시지를 확인하세요

### 6.3 차트가 표시되지 않는 경우
- 최소 2개월 이상의 데이터가 있어야 차트가 정상적으로 표시됩니다